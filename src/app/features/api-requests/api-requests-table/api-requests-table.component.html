<div class="total-loader" *ngIf="greenActive != 1">
    <div>
        <img class="loader-gif web-loader" src="/assets/images/loader.gif" />
        <img class="loader-gif mob-loader" src="/assets/images/coffeeloader-mobile.gif" />
    </div>
</div>

<div *ngIf="greenActive == 1">
    <section>
        <div class="bg-fff coffee-exp">
            <nav role="navigation" aria-labelledby="title-breadcrumb-1" class="breadcrumb1 farm-breadcum">
                <span class="sr-only"></span>
                <ul class="bread-nav pl-48">
                    <li class="b-cum">
                        <a class="b-cum" routerLink="/">{{ globals.languageJson?.home }}</a
                        ><span class="padl-r" aria-hidden="true"
                            ><img class="group-img" src="/assets/images/arrow-1.png" alt="" />
                        </span>
                    </li>
                    <li class="b-cum c-pink">API Requests</li>
                </ul>
            </nav>
            <section class="estate-orders-heading">
                <div class="row justify-content-between align-items-center">
                    <div class="col-lg-8 col-md-4">
                        <h5 class="estate-order-title">API Requests</h5>
                        <p class="Give-your-end-users">
                            Accept, reject API key requests by customers and generate API keys.
                        </p>
                    </div>
                    <div class="col-lg-4 col-md-8 text-right">
                        <div class="file-share-search">
                            <img class="mr-1 mr-md-2" src="assets/images/search.svg" />
                            <input
                                class="fadout-search"
                                type="search"
                                #searchInput
                                [(ngModel)]="apiKeySearch"
                                placeholder="Search by request id or Customer Name "
                                name="filesTerm"
                            />
                        </div>
                    </div>
                </div>

                <div class="header-details row justify-content-between align-items-center">
                    <div class="header-inner col-lg-9 col-md-6">
                        <div
                            class="d-inline border-total col-sm-3"
                            id="status_id"
                            [outsideClick]="true"
                            (onShown)="toggleStatus()"
                            (onHidden)="toggleStatus()"
                            [popover]="allTemplate"
                            placement="bottom"
                            container="body"
                            #pop="bs-popover"
                        >
                            <p class="d-inline filter-text" *ngIf="customerType == ''">Customer Type&nbsp;</p>
                            <a class="pointer-item">
                                <p class="d-inline filter" *ngIf="customerType == ''">
                                    &nbsp;
                                    <img
                                        src="{{
                                            showStatus ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'
                                        }}"
                                    />
                                </p>
                            </a>
                            <a class="pointer-item">
                                <p class="d-inline filter" *ngIf="customerType != ''">
                                    {{ customerType }}&nbsp;
                                    <img
                                        src="{{
                                            showStatus ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'
                                        }}"
                                    />
                                </p>
                            </a>
                        </div>
                        <div class="d-inline border-order date-div col-sm-3" (click)="openCalendar($event)">
                            <p class="d-inline filter-text">
                                Date range &nbsp;
                                <span *ngIf="showDateRange != ''">{{ showDateRange }}</span>
                            </p>

                            <a class="pointer-item">
                                <p class="d-inline filter">
                                    <p-calendar
                                        #calendar
                                        styleClass="only-icon"
                                        [(ngModel)]="rangeDates"
                                        selectionMode="range"
                                        dateFormat="dd.mm.yy"
                                        [readonlyInput]="true"
                                        [showButtonBar]="true"
                                    ></p-calendar>
                                    &nbsp; <img src="assets/images/active-calender.png" alt="" />
                                </p>
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="d-inline">
                            <div class="hover-filters">
                                <div
                                    class="float-right border-order top-space"
                                    id="display_id"
                                    [outsideClick]="true"
                                    (onShown)="toggleDisplay()"
                                    (onHidden)="toggleDisplay()"
                                    [popover]="displayTemplate"
                                    placement="bottom"
                                    [outsideClick]="true"
                                    container="body"
                                    #pop9="bs-popover"
                                >
                                    <p class="d-inline filter-text">Display &#9679;</p>
                                    <a class="pointer-item">
                                        <p class="d-inline filter" *ngIf="perPage == '-1'">
                                            &nbsp; &nbsp;
                                            <img
                                                src="{{
                                                    showDisplay
                                                        ? 'assets/images/down-arrow.svg'
                                                        : 'assets/images/user-down.svg'
                                                }}"
                                            />
                                        </p>
                                    </a>
                                    <a class="pointer-item">
                                        <p class="d-inline filter" *ngIf="perPage != '-1'">
                                            {{ perPage }}&nbsp; &nbsp;
                                            <img
                                                src="{{
                                                    showDisplay
                                                        ? 'assets/images/down-arrow.svg'
                                                        : 'assets/images/user-down.svg'
                                                }}"
                                            />
                                        </p>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="mixups-tabs mt-32 pr-3 col-lg-12 col-md-12">
                        <p-tabView
                            styleClass="pb-3 pb-md-4"
                            [(activeIndex)]="selectedTab"
                            (onChange)="handleChange($event)"
                        >
                            <p-tabPanel header="API Key Requests">
                                <app-api-key-requests
                                    *ngIf="isApiRequestPage"
                                    [searchRequestId]="KeySearch"
                                    [filterData]="customerType"
                                    [dateRange]="rangeDates"
                                    [perPage]="perPage"
                                    (filterType)="setFilterData($event)"
                                ></app-api-key-requests>
                            </p-tabPanel>
                            <p-tabPanel header="Generated Keys">
                                <app-generated-keys
                                    *ngIf="!isApiRequestPage"
                                    [searchRequestId]="KeySearch"
                                    [filterData]="customerType"
                                    [dateRange]="rangeDates"
                                    [perPage]="perPage"
                                    (filterType)="setFilterData($event)"
                                ></app-generated-keys>
                            </p-tabPanel>
                        </p-tabView>
                    </div>
                </div>
            </section>
        </div>
    </section>
    <ng-template #allTemplate>
        <div id="status-content">
            <ul class="list-group custom-popover">
                <li class="list-group-item item-color" *ngFor="let item of FilterTypeList">
                    <a class="pointer-item" (click)="customerTypeFilter(item.org_type); pop.hide()">{{
                        item.org_type
                    }}</a>
                </li>
            </ul>
        </div>
    </ng-template>
    <ng-template #displayTemplate>
        <div id="status-content">
            <ul class="list-group custom-popover">
                <li class="list-group-item item-color" (click)="setDisplay(''); pop9.hide()">
                    <a class="pointer-item">All</a>
                </li>
                <li class="list-group-item item-color" (click)="setDisplay('10'); pop9.hide()">
                    <a class="pointer-item">10</a>
                </li>
                <li class="list-group-item item-color" (click)="setDisplay('20'); pop9.hide()">
                    <a class="pointer-item">20</a>
                </li>
                <li class="list-group-item item-color" (click)="setDisplay('25'); pop9.hide()">
                    <a class="pointer-item">25</a>
                </li>
                <li class="list-group-item item-color" (click)="setDisplay('50'); pop9.hide()">
                    <a class="pointer-item">50</a>
                </li>
            </ul>
        </div>
    </ng-template>
</div>
