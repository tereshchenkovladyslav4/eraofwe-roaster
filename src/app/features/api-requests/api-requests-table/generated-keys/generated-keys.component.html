<div
    class="mb-2 mt-4"
    *ngIf="globals.permissions['coffee-list'].view || globals.permissions['coffee-management'].manage"
>
    <p-table [value]="mainData" [paginator]="true" [lazy]="true" [rows]="40">
        <ng-template pTemplate="header">
            <tr>
                <th>Customer</th>
                <th>Customer type</th>
                <th>Date requested</th>
                <th>Key generated on</th>
                <th>Key status</th>
                <th>{{ globals.languageJson?.actions }}</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
            <tr>
                <td>{{ item.customer }}</td>
                <td>{{ item.customer_type }}</td>
                <td>{{ item.date_requested }}</td>
                <td>{{ item.key_generated_on }}</td>
                <td
                    routerLink="/features/generate-key-details"
                    [ngClass]="item?.key_status === 'Active' ? 'active-status' : 'status-paused'"
                >
                    <img *ngIf="item?.key_status === 'Active'" src="assets/images/active.svg" />
                    <img *ngIf="item?.key_status === 'Paused'" src="assets/images/paused.svg" /><span class="pl-8">{{
                        item.key_status
                    }}</span>
                </td>
                <td>
                    <a
                        class="menu-arrow"
                        [popover]="resumeTemplate ? resumeAccessTemplate : poplistTemplate"
                        placement="left"
                        [outsideClick]="true"
                        #pop="bs-popover"
                    >
                        <p><img class="ellipse-image" src="assets/images/ellipses.png" alt="" /></p>
                    </a>
                    <ng-template #resumeAccessTemplate>
                        <div id="popover-mobile-content">
                            <ul class="list-group custom-popover">
                                <li class="list-group-item">
                                    <a class="pointer-item" (click)="resumeKey(); pop.hide()"
                                        >Resume Access & Notify Customer
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </ng-template>
                    <ng-template #poplistTemplate>
                        <div id="popover-mobile-content">
                            <ul class="list-group custom-popover">
                                <li class="list-group-item">
                                    <a class="pointer-item" (click)="pauseKey(); pop.hide()">Pause Key Access </a>
                                </li>
                                <li class="list-group-item">
                                    <a class="pointer-item" (click)="deleteKey(); pop.hide()">Delete Key</a>
                                </li>
                                <li class="list-group-item">
                                    <a class="pointer-item" (click)="reactiveuser(); pop.hide()">Notifiy customer</a>
                                </li>
                            </ul>
                        </div>
                    </ng-template>
                </td>
            </tr>
        </ng-template>

        <ng-template #deletetemplate>
            <div class="delete-template-modal-body text-center">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 m-0">
                    Are you sure you want to delete the API key for "Third wave coffee roasters"?
                </p>
                <div class="templete-btn">
                    <button class="btn no-btn" (click)="modalRef.hide()">Cancel</button>
                    <button class="btn add-btn ml-3" (click)="onConfirm()">Yes</button>
                </div>
            </div>
        </ng-template>
    </p-table>
</div>
