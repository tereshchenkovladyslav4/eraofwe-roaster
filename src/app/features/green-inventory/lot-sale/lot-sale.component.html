<div class="total-loader" *ngIf="lotSaleActive != 1">
    <!-- <img class="loader-gif-sub" src="/assets/images/loader.gif"> -->
    <div>
        <img class="loader-gif web-loader" src="/assets/images/loader.gif" />
        <img class="loader-gif mob-loader" src="/assets/images/coffeeloader-mobile.gif" />
    </div>
</div>

<div *ngIf="lotSaleActive == 1">
    <section>
        <div class="confirm-ffff mob-sec">
            <section class="create-role">
                <div class="back-icon w-100">
                    <a routerLink="/features/sourcing"
                        ><img src="assets/images/back-arrow-confirm.svg" /> {{ globals.languageJson?.back }}</a
                    >
                </div>
            </section>
        </div>

        <div class="main-block">
            <div class="web-sec">
                <p-breadcrumb [model]="breadItems"></p-breadcrumb>
            </div>
            <section class="mt-4">
                <div class="row w-100 ml-0">
                    <div class="green_grading_cont">
                        <h1>Order #{{ orderDetails?.id }}</h1>
                    </div>
                </div>
                <div class="pull-left mr-auto col-md-7 p-0 min-Text">
                    Manage the price, quantity & delivery charges of coffee marked for sale
                </div>
                <div *ngIf="orderDetails" class="border-div">
                    <div class="row web-sec">
                        <div class="col-12 details-header pb-2">{{ globals.languageJson?.green_coffee_details }}</div>
                        <div class="col-12 lot-content table-responsive">
                            <table class="table lot-table">
                                <thead class="table-head">
                                    <tr>
                                        <th>{{ globals.languageJson?.lot_id }}</th>
                                        <th>Availibility Name</th>
                                        <th>{{ globals.languageJson?.estate }}</th>
                                        <th>{{ globals.languageJson?.origin }}</th>
                                        <th>{{ globals.languageJson?.species }}</th>
                                        <th>{{ globals.languageJson?.variety }}</th>
                                        <th>{{ globals.languageJson?.buying_price }}</th>
                                        <th>{{ globals.languageJson?.cupping_score }}</th>
                                        <th>{{ globals.languageJson?.stock_in_hand }}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{ orderDetails.lot_id ? orderDetails.lot_id : 'NA' }}</td>
                                        <td>
                                            {{ orderDetails.availability_name ? orderDetails.availability_name : 'NA' }}
                                        </td>
                                        <td>{{ orderDetails.estate_name ? orderDetails.estate_name : 'NA' }}</td>
                                        <td>{{ orderDetails.origin ? orderDetails.origin : 'NA' }}</td>
                                        <td>{{ orderDetails.species ? orderDetails.species : 'NA' }}</td>
                                        <td>{{ orderDetails.variety ? orderDetails.variety : 'NA' }}</td>
                                        <td>{{ orderDetails.price ? orderDetails.price : 'NA' }}</td>
                                        <td>{{ orderDetails.cup_score ? orderDetails.cup_score : 'NA' }}</td>
                                        <td>
                                            {{ orderDetails?.quantity }} {{ orderDetails?.quantity_type }},
                                            {{ orderDetails?.quantity_count }}/ kg
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div *ngIf="orderDetails" class="mob-sec">
                        <div class="row">
                            <div class="col-lg-12 mt-2">
                                <div class="estate-list">
                                    <div class="col-12 details-header pb-2">
                                        {{ globals.languageJson?.green_coffee_details }}
                                    </div>
                                    <table class="recent w-100">
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.lot_id }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.lot_id }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.lot_name }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.availability_name }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.estate }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.estate_name }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.origin }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.origin }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.species }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.species }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.variety }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.variety }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.buying_price }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.price }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.cupping_score }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ">{{ orderDetails?.cup_score }}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span class="list-ques">{{ globals.languageJson?.stock_in_hand }}</span>
                                            </td>
                                            <td>
                                                <span class="list-answ"
                                                    >{{ orderDetails?.quantity }} {{ orderDetails?.quantity_type }},
                                                    {{ orderDetails?.quantity_count }}/ bag</span
                                                >
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="mt-48" [formGroup]="lotSaleForm" (ngSubmit)="onSave()" novalidate>
                <div class="green_grading_cont row w-100 border-bottom-gray pb-3 mx-0">
                    <div class="col-sm-12 col-md-9 col-lg-9 col-xl-9 px-0">
                        <h1>{{ globals.languageJson?.sale_information }}</h1>
                        <div class="col-12 pull-left p-0 pb-24 min-Text">
                            Manage the price, quantity & delivery charges of coffee marked for sale
                        </div>
                    </div>

                    <div *ngIf="!showDropdown" class="col-sm-12 col-md-3 col-lg-3 col-xl-3 current-s-bg">
                        <p class="fnt-14 fnt-muli fnt-400 text-clr334 m-0">Current status</p>
                        <span class="fnt-14 fnt-700 fnt-muli text-clr334">{{ status_label }}</span>
                        <span *ngIf="!readOnlyMode" class="text-brown float-right" (click)="showDropdown = true"
                            ><a>Change status</a>
                        </span>
                    </div>

                    <!-- change status-->
                    <!-- <div *ngIf="showDropdown" class="col-sm-12 col-md-3 col-lg-3 col-xl-3 current-s-bg d-flex">
                        <div class="farm-input">
                            <select
                                class="form-control select-region status-width"
                                [(ngModel)]="order_status"
                                name="coffee"
                                required=""
                            >
                                <option value="IN_STOCK" selected>In Stock</option>
                                <option value="SOLD">Sold</option>
                                <option value="HIDDEN">Hidden</option>
                            </select>
                        </div>
                        <span (click)="updateStatus()" class="text-brown pl-4 pt-2"><a>Save</a> </span>
                    </div> -->
                    <div
                        *ngIf="showDropdown"
                        class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100 current-s-bg d-flex"
                    >
                        <p-dropdown
                            [options]="stockTypeArray"
                            optionLabel="label"
                            placeholder="In Stock"
                            [style]="{ width: '100%' }"
                            formControlName="status"
                            optionValue="value"
                        ></p-dropdown>
                        <small *ngIf="lotSaleForm.controls['status'].errors?.required" class="p-error">
                            Required
                        </small>
                        <span (click)="updateStatus()" class="text-brown pl-4 pt-2"><a>Save</a> </span>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 sewn-form-field w-100">
                        <label>Product name<span class="star">*</span></label>
                        <input
                            type="text"
                            placeholder="Give a name to this green coffee"
                            formControlName="name"
                            pInputText
                        />
                        <small *ngIf="lotSaleForm.controls['name'].errors?.required" class="p-error"> Required </small>
                    </div>
                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 sewn-form-field w-100">
                        <label>Selling price<span class="star">*</span>(in USD)</label>
                        <div class="input-group weightInputGroupDiv">
                            <input
                                type="number"
                                class="weightInputDiv"
                                formControlName="price"
                                placeholder="Enter the selling price"
                                pInputText
                            />

                            <div class="input-group-append">
                                <p-dropdown
                                    [options]="priceTypeArray"
                                    optionLabel="label"
                                    placeholder=""
                                    [style]="{ width: '100%', border: '0px', 'background-color': '#f8f8f8' }"
                                    formControlName="price_per_unit"
                                    optionValue="value"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <small
                            *ngIf="
                                lotSaleForm.controls['price'].errors?.required &&
                                lotSaleForm.controls['price_per_unit'].errors?.required
                            "
                            class="p-error"
                        >
                            Required
                        </small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100">
                        <label>Quantity for sale<span class="star">*</span></label>
                        <div class="input-group weightInputGroupDiv">
                            <input
                                type="number"
                                class="weightInputDiv"
                                formControlName="quantity_count"
                                placeholder="Enter a number"
                                pInputText
                            />

                            <div class="input-group-append">
                                <p-dropdown
                                    [options]="quantityUnitArray"
                                    optionLabel="label"
                                    placeholder="Bags"
                                    [style]="{ width: '100%', border: '0px', 'background-color': '#f8f8f8' }"
                                    formControlName="quantity_type"
                                    optionValue="value"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <small
                            *ngIf="
                                lotSaleForm.controls['quantity_count'].errors?.required &&
                                lotSaleForm.controls['quantity_type'].errors?.required
                            "
                            class="p-error"
                        >
                            Required
                        </small>
                    </div>
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100">
                        <label>Remaining quantity<span class="star">*</span></label>
                        <input type="text" placeholder="-" pInputText disabled />
                    </div>
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100">
                        <label>Minimum order quantity<span class="star">*</span></label>
                        <div class="input-group weightInputGroupDiv">
                            <input
                                type="number"
                                class="weightInputDiv"
                                formControlName="minimum_order_quantity_count"
                                placeholder="Enter a number"
                                pInputText
                            />

                            <div class="input-group-append">
                                <p-dropdown
                                    [options]="quantityUnitArray"
                                    optionLabel="label"
                                    placeholder="kg"
                                    [style]="{ width: '100%', border: '0px', 'background-color': '#f8f8f8' }"
                                    formControlName="quantity_unit"
                                    optionValue="value"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <small
                            *ngIf="
                                lotSaleForm.controls['minimum_order_quantity_count'].errors?.required &&
                                lotSaleForm.controls['quantity_unit'].errors?.required
                            "
                            class="p-error"
                        >
                            Required
                        </small>
                    </div>
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100">
                        <label>Weight / bag<span class="star">*</span></label>
                        <div class="input-group weightInputGroupDiv">
                            <input
                                type="number"
                                class="weightInputDiv"
                                formControlName="quantity"
                                placeholder="Enter a number"
                                pInputText
                            />

                            <div class="input-group-append">
                                <p-dropdown
                                    [options]="quantityUnitArray"
                                    optionLabel="label"
                                    placeholder="Bags"
                                    [style]="{ width: '100%', border: '0px', 'background-color': '#f8f8f8' }"
                                    formControlName="quantity_unit"
                                    optionValue="value"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <small
                            *ngIf="
                                lotSaleForm.controls['quantity'].errors?.required &&
                                lotSaleForm.controls['quantity_unit'].errors?.required
                            "
                            class="p-error"
                        >
                            Required
                        </small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 sewn-form-field w-100">
                        <label>VAT role<span class="star">*</span></label>
                        <p-dropdown
                            [options]="vatDetailsArray"
                            optionLabel="label"
                            placeholder="Select a transaction role"
                            [style]="{ width: '100%' }"
                            formControlName="vat_settings_id"
                            optionValue="value"
                        ></p-dropdown>
                        <small *ngIf="lotSaleForm.controls['vat_settings_id'].errors?.required" class="p-error">
                            Required
                        </small>
                    </div>
                </div>

                <div class="col-lg-12 col-md-12 no-padding-RL">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 web-sec">
                            <div class="float-left mt-48 mb-48">
                                <button class="btn btn-stroked mt-32" (click)="deleteProductFromList()">
                                    Delete product from listing
                                </button>
                            </div>

                            <div class="float-right mt-48 mb-48">
                                <button type="button" class="btn btn-stroked mt-32" (click)="onCancel()">Cancel</button>
                                <button type="submit" class="ml-3 btn-raised btn" (click)="onSave()">
                                    Save changes
                                </button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12 w-100 mob-sec">
                            <button class="btn btn-stroked w-100 mt-3" (click)="deleteProductFromList()">
                                Delete product from listing
                            </button>
                            <button type="submit" class="w-100 btn-raised btn mt-3" (click)="onSave()">
                                Save changes
                            </button>
                            <button type="button" class="btn btn-stroked mt-3 w-100" (click)="onCancel()">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </section>
</div>
