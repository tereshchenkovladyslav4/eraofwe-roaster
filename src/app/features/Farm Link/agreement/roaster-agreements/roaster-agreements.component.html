<section class="estate-orders">
    <div class="row pl-3">
        <p-dropdown id="select-customer" [options]="newList" [(ngModel)]="selectedCustomers" scrollHeight="225px"
            (onChange)="filterAgrements()" [showClear]="true" placeholder="Select customer"
            styleClass="round-border mr-25 mb-25 mb-md-4"></p-dropdown>
    </div>
    <div class="estate-table web-farm">
        <div class="table-responsive border-lots">
            <table class="table">
                <thead class="table-header">
                    <tr class="header-row">
                        <th id="bord-left">{{ globals.languageJson?.files }}
                            <img src="../../../../../assets/images/arrow-up.svg" class="arrow-align pl-2"
                                (click)="onDescendingSort('file_name')"
                                *ngIf="isAscending && sortColumnName === 'file_name'">
                            <img src="../../../../../assets/images/arrow-down.svg" class="arrow-align pl-2"
                                (click)="onDefaultSort()" *ngIf="isDescending && sortColumnName === 'file_name' ">
                            <img src="../../../../../assets/images/combined-shape-user.svg" class="pl-2"
                                (click)="onAscendingSort('file_name')"
                                *ngIf="!isAscending && !isDescending || sortColumnName !== 'file_name'">
                        </th>
                        <th scope="col">{{ globals.languageJson?.added_on }}
                            <img src="../../../../../assets/images/arrow-up.svg" class="arrow-align pl-2"
                                (click)="onDescendingSort('created_at')"
                                *ngIf="isAscending && sortColumnName === 'created_at'">
                            <img src="../../../../../assets/images/arrow-down.svg" class="arrow-align pl-2"
                                (click)="onDefaultSort()" *ngIf="isDescending && sortColumnName === 'created_at'">
                            <img src="../../../../../assets/images/combined-shape-user.svg" class="pl-2"
                                (click)="onAscendingSort('created_at')"
                                *ngIf="!isAscending && !isDescending || sortColumnName !== 'created_at'">
                        </th>
                        <th scope="col">{{ globals.languageJson?.customer_name }}
                            <img src="../../../../../assets/images/arrow-up.svg" class="arrow-align pl-2"
                                (click)="onDescendingSort('customer_name')"
                                *ngIf="isAscending && sortColumnName === 'customer_name'">
                            <img src="../../../../../assets/images/arrow-down.svg" class="arrow-align pl-2"
                                (click)="onDefaultSort()" *ngIf="isDescending && sortColumnName === 'customer_name'">
                            <img src="../../../../../assets/images/combined-shape-user.svg" class="pl-2"
                                (click)="onAscendingSort('customer_name')"
                                *ngIf="!isAscending && !isDescending || sortColumnName !== 'customer_name'">
                        </th>
                        <th scope="col">{{ globals.languageJson?.origin }}
                            <img src="../../../../../assets/images/arrow-up.svg" class="arrow-align pl-2"
                                (click)="onDescendingSort('origin')" *ngIf="isAscending && sortColumnName === 'origin'">
                            <img src="../../../../../assets/images/arrow-down.svg" class="arrow-align pl-2"
                                (click)="onDefaultSort()" *ngIf="isDescending && sortColumnName === 'origin'">
                            <img src="../../../../../assets/images/combined-shape-user.svg" class="pl-2"
                                (click)="onAscendingSort('origin')"
                                *ngIf="!isAscending && !isDescending || sortColumnName !== 'origin'">
                        </th>
                        <th id="bord-right"></th>
                    </tr>
                </thead>
                <tbody class="customtable" *ngIf="sortedMainData && sortedMainData.length > 0">
                    <tr class="ticket-boby-txt"
                        *ngFor="let item of sortedMainData | filter: searchTerm | filter: estatetermOrigin">
                        <td>
                            <a href="{{item.file_url}}" target="_blank" class="file_url"><span><img
                                        class="file-icon pr-2" src="assets/images/pdf-img.PNG" alt="upload-icon" />
                                    {{ item.file_name }}</span></a>
                        </td>
                        <td>{{ item.created_at | date: 'M/d/yy, h:mm a' }}</td>
                        <td>{{ item.customer_name }}</td>
                        <td>{{ getCountryName(item.origin) }}</td>
                        <td>
                            <a class="menu-arrow" [popover]="poplistTemplate" placement="left" [outsideClick]="true"
                                #pop="bs-popover">
                                <p><i class="pi pi-ellipsis-v"></i></p>
                            </a>
                            <ng-template #poplistTemplate id="{{ item.id }}">
                                <div id="popover-mobile-content">
                                    <ul class="list-group custom-popover">
                                        <li class="list-group-item">
                                            <a class="pointer-item" (click)="pop.hide();onUpdateModal(item.id)"
                                                data-toggle="modal" data-target="#uploadfolder">{{
                                                globals.languageJson?.update }}</a>
                                        </li>
                                        <li class="list-group-item">
                                            <a class="pointer-item" (click)="pop.hide();deleteAgreementId = item.id"
                                                data-toggle="modal" data-target="#deletemodal">{{
                                                globals.languageJson?.delete }}</a>
                                        </li>
                                    </ul>
                                </div>
                            </ng-template>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="estate-table pt-md-2 mobile-farm">
        <div class="table-details mobile-farm">
            <div class="table-responsive border-sourcetable agreement-top">
                <div class="col-12 bor-d6d6" *ngFor="let data of mainData | filter: customerMob">
                    <div class="row pt-4">
                        <div class="col-2"><img class="" src="assets/images/pdf-img.PNG" alt="upload-icon" /></div>
                        <div class="col-10 mobile-ce">
                            <p class="black fnt-14">{{ data.file_name }}</p>
                            <p class="fnt-12 light-eight">Added on {{ data.created_at | date: 'M/d/yy, h:mm a' }}</p>
                            <p class="fnt-12 light-eight">{{ data.customer_name }}</p>
                            <p class="fnt-12 light-eight">{{ getCountryName(data.origin) }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="uploadfolder" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-lg modal-large" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fnt-18 fnt-muli fnt-700 text-black2424 mb-0">
                    {{ globals.languageJson?.upload_new_agreement }}
                </h5>
                <button type="button" id="dismissAddModal" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="">
                    <form>
                        <div class="invite-to">
                            <div class="roastery-fields mb-3 mb-lg-4">
                                <h4 class="fnt-16 fnt-700 fnt-muli text-clr334 mb-0">
                                    Select the type of customer you want to upload the agreement for
                                </h4>
                                <div class="row mt-3">
                                    <span class="pl-3">
                                        <input type="radio" id="horeca_customer_add" name="horeca_customer" value="hrc"
                                            [formControl]="horecaFormGroup.controls['customerType']" />
                                        <label for="horeca_customer_add" class="pl-2">HoReCa</label><br />
                                    </span>
                                    <span class="pl-3">
                                        <input type="radio" id="mr_customer_add" name="horeca_customer" value="mr"
                                            [formControl]="horecaFormGroup.controls['customerType']" />
                                        <label class="pl-2" for="mr_customer_add">Micro-Roaster</label><br />
                                    </span>
                                </div>
                            </div>

                            <div class="roastery-fields mb-3 mb-lg-4">
                                <h4 class="fnt-16 fnt-700 fnt-muli text-clr334 mb-0">
                                    {{ globals.languageJson?.select_customer }} <span class="star-mark">*</span>
                                </h4>
                                <select [formControl]="horecaFormGroup.controls['customerId']" class="customer px-2"
                                    name="customerId" id="customerId">
                                    <option value="">Please select customer</option>
                                    <option *ngFor="let horeca of newList" value="{{ horeca.id }}">
                                        {{ horeca.name }}
                                    </option>
                                </select>
                                <div class="mt-1"
                                    *ngIf="horecaFormGroup.controls['customerId'].invalid && horecaFormGroup.controls['customerId'].touched">
                                    <small class="p-invalid pl-1 pt-3"
                                        *ngIf="horecaFormGroup.controls['customerId'].errors?.required">Please Select
                                        Customer Id</small>
                                </div>
                            </div>
                            <div class="roastery-fields mb-0">
                                <div class="farm-input col-12 col-md-8 px-0">
                                    <h4 class="fnt-16 fnt-700 fnt-muli text-clr334 mb-0">
                                        {{ globals.languageJson?.upload }}
                                    </h4>
                                    <span class="d-block fnt-14 fnt-500 text-clr588 fnt-muli text-clr334 mb-1">{{
                                        globals.languageJson?.please_upload_document
                                        }}</span>
                                    <label class="share-bor custom-width-30 d-inline-block">
                                        <input class="file-input" accept="application/pdf" type="file"
                                            (change)="uploadFile($event)" /><img class="dwnd-img"
                                            src="assets/images/group-6.svg" alt="upload-icon" />
                                        <span class="share-txt"> {{ globals.languageJson?.upload }} </span>
                                    </label>
                                    <span class="value-name pl-3">{{ fileNameValue }}</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-raised fnt-14 fnt-700 fnt-muli" (click)="uploadAgreement()"
                    [disabled]="resetButtonValue === 'Uploading' || !(horecaFormGroup.get('customerId').valid && fileNameValue)">
                    {{ resetButtonValue}}
                    <img class="loader" *ngIf="resetButtonValue === 'Uploading'"
                        src="assets/images/orange-loader.gif" />
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deletemodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-small" role="document">
        <div class="modal-content">
            <div class="modal-body mt-5 mb-5 text-center fnt-muli">
                <div><img src="assets/images/delete-role.svg" alt="" /></div>
                <div class="fnt-muli fnt-18 fnt-normal delete__text mt-3">
                    <p class="oh-noh pb-3 mb-0">Oh noh :(</p>
                    <p class="mb-0">You sure you really want to delete this?</p>
                </div>
                <div class="mt-5">
                    <button class="btn-stroked btn-padding" id="dismissDeleteModal" data-dismiss="modal">{{
                        globals.languageJson?.cancel }}</button>
                    <button class="btn-raised btn-padding ml-3" (click)="deleteAgreement(deleteAgreementId)">
                        {{ globals.languageJson?.delete }}
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>