<div class="total-loader" *ngIf="teamActive != 2">
    <!-- <img class="loader-gif-sub" src="/assets/images/loader.gif"> -->
    <div><img class="loader-gif web-loader" src="/assets/images/loader.gif">
        <img class="loader-gif mob-loader" src="/assets/images/coffeeloader-mobile.gif">
    </div>
</div>
<div  *ngIf="teamActive == 2">
<nav role="navigation" aria-labelledby="title-breadcrumb-1" class="breadcrumb1">
    <span id="title-breadcrumb-1" class="sr-only"></span>
    <ul class="bread-nav">
        <li class="b-cum">
            <a class="b-cum" routerLink="/features/welcome-aboard">{{globals.languageJson?.home}}</a><span class="padl-r" aria-hidden="true"><img class="group-img" src="/assets/images/arrow-1.png" alt=""></span>
        </li>
        <li class="b-cum">
            <a class="b-cum">{{globals.languageJson?.people}}</a><span class="padl-r" aria-hidden="true"><img class="group-img" src="/assets/images/arrow-1.png" alt=""></span>
        </li>

        <li class="b-cum c-pink">{{globals.languageJson?.manage_roles}}
        </li>
    </ul>
</nav>

<section class="team__total d-md-block d-none">
    <div class="row">
        <div class="d-inline add-team col-lg-8">{{globals.languageJson?.add_team_members}}
            <span class="d-inline select_title" (click)="op.toggle($event)">
                    {{this.teamRole}} 
            <img src="assets/images/active.png" alt="user" class="icon-select image_cursor" /></span>
            <div class="select-members mt-1">{{globals.languageJson?.select_members_role}}</div>

        </div>
        <div class="col-lg-4">
            <button type="submit"  class="btn invite_members pull-right" (click)="inviteNewMembers();">
                <span class="update_text">{{globals.languageJson?.invite_new_members}}</span>
            </button>
        </div>        
    </div>
    <div class="row">
        <div class="col-lg-8">
        <div class="d-inline border-total status-div col-sm-6" id="status_id">
            <p class="d-inline filter-text" *ngIf="termStatus == ''">{{globals.languageJson?.status}}&nbsp;</p>
            <a class="pointer-item" [popover]="allTemplate" placement="bottom" container="body" #pop2="bs-popover">
                <p class="d-inline filter" *ngIf="termStatus == ''" (click)="toggleStatus()">
                    &nbsp; <img src="{{ showVar ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'}}" />
                </p>
            </a>
            <a class="pointer-item" [popover]="allTemplate" placement="bottom" container="body" #pop="bs-popover">
                <p class="d-inline filter" *ngIf="termStatus != ''" (click)="toggleStatus()">
                    {{ termStatus }}&nbsp; <img src="{{ showVar ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'}}" />
                </p>
            </a>
        </div>
        &nbsp;&nbsp;
        <div class="d-inline border-total role-div col-sm-6" id="role_id">
            <p class="d-inline filter-text" *ngIf="termRole == ''">{{globals.languageJson?.role}}&nbsp;</p>
            <a class="pointer-item" [popover]="roleTemplate" placement="bottom" container="body" #pop3="bs-popover">
                <p class="d-inline filter" *ngIf="termRole == ''" (click)="toggleRole();">
                    &nbsp; <img src="{{ showRole ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'}}" />
                </p>
            </a>
            <a class="pointer-item" [popover]="roleTemplate" placement="bottom" container="body" #pop1="bs-popover">
                <p class="d-inline filter" *ngIf="termRole != ''" (click)="toggleRole();">
                    {{ termRole }}&nbsp;<img src="{{ showRole ? 'assets/images/down-arrow.svg' : 'assets/images/user-down.svg'}}" />
                </p>
            </a>
        </div>
    </div>
         <div class="col-md-6 col-lg-4 search-div ">
            <input type="text" name="search" class="search-raised pull-right" [(ngModel)]="term" placeholder="{{globals.languageJson?.search_name_role}}" />
        </div>
    </div>
    <div class="table-container mb-2">
        <div class="table-responsive">
            <table class="table">
                    <thead class="table-header">
                            <tr class="header-row">
                                <th>
                                    <label class="customcheckbox m-b-20">
                                            <input type="checkbox" id="mainCheckbox"  [checked]="isAllChecked()"
                                            (change)="checkAll($event)"/>
                                            <span class="checkmark head-check"></span>
                                        </label>
                                </th>
                                <th scope="col">{{globals.languageJson?.name}}</th>
                                <th scope="col">
                                    {{globals.languageJson?.last_login}}&nbsp; <img src="assets/images/combined-shape-user.png" />
                                </th>
                                <th scope="col">{{globals.languageJson?.email}}</th>
                                <th scope="col">{{globals.languageJson?.status}}</th>
                                <th scope="col">
                                    <p class="d-inline">{{globals.languageJson?.all_roles}}</p>
                                    <a class="pointer-item" [popover]="roleTemplate" placement="bottom" [outsideClick]="true" container="body" #pop5="bs-popover">
                                        <p class="d-inline filter" *ngIf="termRole == ''">
                                            &nbsp; <img src="assets/images/down-arrow.svg" /></p>
                                    </a>
                                    <a class="pointer-item" [popover]="roleTemplate" placement="bottom" [outsideClick]="true" container="body" #pop6="bs-popover">
                                        <p class="d-inline filter" *ngIf="termRole != ''">
                                            &nbsp;<img src="assets/images/down-arrow.svg" /></p>
                                    </a>
                                </th>
                                <!-- <th scope="col">{{globals.languageJson?.actions}}</th> -->
                            </tr>
                        </thead>
                        <tbody class="customtable" *ngIf="this.globals.permissions['user-management'].view || this.globals.permissions['user-management'].manage">
                            <tr class="ticket-boby-txt" *ngFor="let user of userfilterDat | filter:term | filter: termRole | filter: termStatus | filter: roleData">
                                <td>
                                    <label class="customcheckbox">
                                            <input type="checkbox" class="listCheckbox"  name="sizecb[]" value="{{user.id}}"  (change)="checkedValue($event,user.id);"  [(ngModel)]="user.state"/>
                                            <span class="checkmark head-check"></span>
                                        </label>
                                </td>
                                <td class="table_ellipsis">{{ user.name }}<span class="tooltiptext">{{ user.name }}</span>
                                </td>
                                <td>{{ user.lastLogin }}</td>
                                <td>{{ user.email }} </td>
                                <td>
                                    <p class="status-active" *ngIf="user.status == 'ACTIVE'">
                                        &#9679; {{ user.status | titlecase }}
                                    </p>
                                    <p class="status-disabled" *ngIf="user.status == 'INACTIVE'">
                                        &#9679; {{ user.status | titlecase }}
                                    </p>
                                </td>
                                <td>
                                    <div *ngFor="let value of user.roles" id="{{ value.id }}_{{ user.id }}">
                                        <!-- <button type="submit" id="delete_row" class=" delete_row" data-toggle="tooltip" data-placement="top" title="Delete"  name="action" value="DELETE">
                         <img src="assets/images/delete.png" alt="">
                        </button> -->
                                        <span class="delete_name_txt"> {{ value.name }} </span> <br />
                                    </div>
                                </td>
                               
                                <!-- <td>
                                    <a class="menu-arrow" [popover]="poplistTemplate" placement="left" [outsideClick]="true" #pop="bs-popover">
                                        <p><img class="ellipse-image" src="assets/images/more-opns-file.png" alt=""></p>
                                    </a>
                                    <ng-template #poplistTemplate id="{{user.id}}">
                                        <div id="popover-mobile-content">
                                            <ul class="list-group custom-popover">
                                                <li class="list-group-item" *ngIf="user.id != loginId">
                                                    <a class="pointer-item" (click)="openDeleteModal(deleteTemplate,user.id); pop.hide()">{{globals.languageJson?.delete}}</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </ng-template>
                                </td> -->
                            </tr>
                        </tbody>
            </table>
        </div>
    </div> 
    <div class="mt-4">
        <button type="button" class="btn cancel_member mt-4" routerLink="/people/manage-role">{{globals.languageJson?.cancel}}</button>
        <button *ngIf="showAssignBtn" type="button" class="btn invite_members mt-4 pull-right ml-auto" (click)="assignUsersToRole()">{{globals.languageJson?.assign}}</button>
    </div>                   
</section>

<p-overlayPanel #op [dismissable]="true" appendTo="body">
        <div class="overflow-popover">
            <ul class="custom-popover">
                <!-- <li class="content_list" (click) = "setRole('Sales and Marketing')">Sales and Marketing</li> -->
                <li class="content_list" *ngFor="let role of roles" (click)="setTeamRole(role.name,role.id);op.hide();">{{role.name}}</li>
            </ul>
            <button class="btn addrole_button" routerLink="/people/create-role">{{globals.languageJson?.add_role}}
                  <!-- <span class="addrole_content">Add role</span> -->
            </button>
        </div>
    </p-overlayPanel>

    <ng-template #roleTemplate>
            <div>
              <ul class="list-group">
                <li class="list-group-item item-color">
                  <a class="pointer-item" (click)="setRole(''); pop3.hide(); pop1.hide();pop5.hide();pop6.hide();toggleRole()"
                    >All</a>
                </li>
                <li class="list-group-item item-color" *ngFor="let role of roles">
                  <a
                    class="pointer-item"
                    (click)="setRole(role.name); pop1.hide(); pop3.hide();pop5.hide();pop6.hide();toggleRole()"
                    >{{ role.name }}</a>
                </li>
              </ul>
            </div>
          </ng-template>
          <ng-template #allTemplate>
                <div id="status-content">
                  <ul class="list-group">
                    <li class="list-group-item item-color">
                      <a class="pointer-item" (click)="setStatus(''); pop.hide(); pop2.hide();toggleStatus()"
                        >All</a>
                    </li>
                    <li class="list-group-item item-color">
                      <a
                        class="pointer-item"
                        (click)="setStatus('Active'); pop.hide(); pop2.hide();toggleStatus()"
                        >Active</a>
                    </li>
                    <li class="list-group-item item-color">
                      <a
                        class="pointer-item"
                        (click)="setStatus('Inactive'); pop.hide(); pop2.hide();toggleStatus()"
                        >Inactive</a>
                    </li>
                    <li class="list-group-item item-color">
                        <a
                          class="pointer-item"
                          (click)="setStatus('Pending'); pop.hide(); pop2.hide();toggleStatus()"
                          >Pending</a>
                      </li>
                  </ul>
                </div>
              </ng-template>              
</div>              


<ng-template #deleteTemplate>
    <!-- <div class="modal-header border-header">
        <h1 class="fnt-play head-roles">Manage roles</h1>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
    </div> -->
    <div class="modal-body mt-5 mb-5 text-center fnt-muli">
       <div><img src="assets/images/delete-role.svg" alt=""></div>
       <div class="fnt-play fnt-24 fnt-bold oh__text mt-2">Oh noh :(</div>
       <div class="fnt-muli fnt-18 fnt-normal delete__text mt-2 pb-3">You sure you really want to delete this?</div>
       <div class="mt-4">
            <button class="cancel-btn" (click)="modalRef.hide();">{{globals.languageJson?.cancel}}</button>
            <button class="btn delete-btn ml-3" (click)="modalRef.hide();deleteRoasterUser(deleteUserId);">{{globals.languageJson?.delete}}</button>
       </div>
    </div>
</ng-template>