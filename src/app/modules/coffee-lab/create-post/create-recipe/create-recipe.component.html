<div class="recipe-post-wrapper bg-f8">
    <div class="row" [formGroup]="recipeForm" (ngSubmit)="onSave()" novalidate>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100" *ngIf="id">
            <p-dropdown
                [options]="applicationLanguages"
                optionLabel="label"
                placeholder="Select translate language"
                [style]="{ width: '100%' }"
                optionValue="value"
                formControlName="language"
                class="inputFieldBox"
            ></p-dropdown>
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 sewn-form-field w-100">
            <label>Add a cover image<span class="star">*</span></label>
            <div class="addImageContainer d-flex align-items-center justify-content-center imagesDiv">
                <label class="d-block align-items-center justify-content-center pointer-item">
                    <input
                        type="file"
                        accept="image/png, image/jpeg"
                        style="display: none"
                        #featureImage
                        (change)="uploadImage($event, 0, 'recipeCoverImage')"
                    />
                    <div class="d-block flex-wrap align-items-center justify-content-center">
                        <div class="oval">
                            <span><i class="pi fa fa-plus text-clr588 fnt-16"></i></span>
                        </div>
                        <span class="d-none d-sm-none d-md-block secondary_txt dragColor my-25"
                            >Add a cover image<span class="star">*</span></span
                        >
                        <span class="d-none d-sm-none d-md-block secondary_txt dragColor">(max size 2mb)</span>
                    </div>
                </label>
            </div>
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 sewn-form-field w-100">
            <label>Recipe Name<span class="star">*</span></label>
            <input type="text" placeholder="Enter Recipe Name" pInputText formControlName="name" />
            <small *ngIf="recipeForm.controls['name'].errors?.required" class="p-error"> Required </small>
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 sewn-form-field w-100">
            <label>Recipe Description<span class="star">*</span></label>
            <app-forum-editor
                [(content)]="description"
                [(isUploadingImage)]="isUploadingImage"
                [(imageIdList)]="imageIdList"
                fileModule="recipe-post"
            ></app-forum-editor>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
            <label>Expertise<span class="star">*</span></label>
            <p-dropdown
                [options]="expertiseArray"
                optionLabel="label"
                placeholder="Select level"
                [style]="{ width: '100%' }"
                optionValue="value"
                class="inputFieldBox"
                formControlName="expertise"
            ></p-dropdown>
            <small *ngIf="recipeForm.controls['expertise'].errors?.required" class="p-error"> Required </small>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
            <label>Serves<span class="star">*</span></label>
            <input type="text" placeholder="Enter number of servings" formControlName="serves" pInputText />
            <small *ngIf="recipeForm.controls['serves'].errors?.required" class="p-error"> Required </small>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
            <label>Preparation time<span class="star">*</span></label>
            <div class="p-inputgroup custom-addon dropdownClass inputFieldBox">
                <input
                    type="number"
                    placeholder="Give a preparation time"
                    formControlName="preparation_time"
                    pInputText
                />
                <span class="p-inputgroup-addon">
                    <p-dropdown
                        placeholder="Give a preparation time"
                        [style]="{ width: '100%', height: '40px', border: '0px', background: '#f8f8f8' }"
                        [options]="preparationArray"
                        optionLabel="label"
                        optionValue="value"
                        class="inputFieldBox"
                        formControlName="preparation_time_unit"
                    ></p-dropdown>
                </span>
                <small *ngIf="recipeForm.controls['preparation_time'].errors?.required" class="p-error">
                    Required
                </small>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
            <label>Cooking time<span class="star">*</span></label>
            <div class="p-inputgroup custom-addon dropdownClass inputFieldBox">
                <input type="number" placeholder="Enter Cooking Time" formControlName="cooking_time" pInputText />
                <span class="p-inputgroup-addon">
                    <p-dropdown
                        placeholder="mins"
                        [style]="{ width: '100%', height: '40px', border: '0px', background: '#f8f8f8' }"
                        [options]="preparationArray"
                        optionLabel="label"
                        optionValue="value"
                        formControlName="cooking_time_unit"
                        class="inputFieldBox"
                    ></p-dropdown>
                </span>
                <small *ngIf="recipeForm.controls['cooking_time'].errors?.required" class="p-error"> Required </small>
            </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 my-3 d-flex">
            <span class="primary_txt fnt-14">List of ingredients<span class="star">*</span></span>
        </div>
        <ng-container
            formArrayName="ingredients"
            *ngFor="let ingredient of recipeForm.controls['ingredients']['controls']; let i = index; last as isLast"
        >
            <div [formGroupName]="i" class="p-0 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
                    <label>Ingredient<span class="star">*</span></label>
                    <input type="text" placeholder="Ingredient Name" pInputText formControlName="name" />
                    <small *ngIf="ingredient.controls['name'].errors?.required" class="p-error"> Required </small>
                </div>

                <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
                    <label>Quantity<span class="star">*</span></label>
                    <div class="p-inputgroup custom-addon dropdownClass inputFieldBox">
                        <input type="text" placeholder="Ingredient Quantity" pInputText formControlName="quantity" />
                        <span class="p-inputgroup-addon">
                            <p-dropdown
                                [options]="qualityArray"
                                optionLabel="label"
                                placeholder="Select level"
                                optionValue="value"
                                formControlName="quantity_unit"
                                class="inputFieldBox"
                                [style]="{ width: '100%', height: '40px', border: '0px', background: '#f8f8f8' }"
                            ></p-dropdown>
                        </span>
                        <small *ngIf="ingredient.controls['quantity'].errors?.required" class="p-error">
                            Required
                        </small>
                    </div>
                </div>
            </div>
        </ng-container>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-2 mb-3 d-flex">
            <span class="fnt-14"
                ><span class="editBtn cursor-pointer" (click)="addIngredient()">Add ingredients</span
                ><span class="star">*</span></span
            >
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 my-3 d-flex">
            <span class="primary_txt fnt-14">Method of preparation<span class="star">*</span></span>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100">
            <p-dropdown
                [options]="expertiseArray"
                optionLabel="label"
                placeholder="Add step by step introduction & video"
                [style]="{ width: '100%' }"
                optionValue="value"
                class="inputFieldBox"
                formControlName="preparation_method"
            ></p-dropdown>
            <small *ngIf="recipeForm.controls['preparation_method'].errors?.required" class="p-error"> Required </small>
        </div>
        <div class="row col-sm-12 col-md-12 col-lg-12 col-xl-12">
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 sewn-form-field w-100 pr-0">
                <label>Upload a video of the recipe (optional)<span class="star">*</span></label>
                <div class="addImageContainer d-flex align-items-center justify-content-center imagesDiv">
                    <label class="d-block align-items-center justify-content-center pointer-item">
                        <input
                            type="file"
                            style="display: none"
                            #featureImage
                            (change)="uploadImage($event, 0, 'recipeVideo')"
                        />
                        <div class="d-block flex-wrap align-items-center justify-content-center">
                            <!-- <img src="assets/images/upload_icon.svg" /> -->
                            <div class="oval">
                                <span><i class="pi fa fa-plus text-clr588 fnt-16"></i></span>
                            </div>
                            <span class="d-none d-sm-none d-md-block secondary_txt dragColor my-25"
                                >Add a video<span class="star">*</span></span
                            >
                            <span class="d-none d-sm-none d-md-block secondary_txt dragColor">(max size 2mb)</span>
                        </div>
                    </label>
                </div>
            </div>
        </div>

        <ng-container *ngFor="let step of recipeForm?.value?.steps; let i = index; last as isLast">
            <div class="p-0 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                <div class="col-sm-12 col-md-12 col-lg-12 col-xl-9 sewn-form-field w-100">
                    <label>Step {{ i + 1 }}<span class="star">*</span></label>
                    <app-forum-editor
                        [(content)]="step.description"
                        [(isUploadingImage)]="isUploadingImage"
                        [(imageIdList)]="imageIdListStep[i]"
                        fileModule="recipe-post"
                    ></app-forum-editor>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-12 col-xl-3 sewn-form-field w-100">
                    <label>Add image</label>
                    <div class="stepAddImageContainer d-flex align-items-center justify-content-center imagesDiv">
                        <label class="d-block align-items-center justify-content-center pointer-item">
                            <input
                                type="file"
                                accept="image/png, image/jpeg"
                                style="display: none"
                                #featureImage
                                (change)="uploadImage($event, 0, 'stepImage')"
                            />
                            <div class="d-block flex-wrap align-items-center justify-content-center">
                                <!-- <img src="assets/images/upload_icon.svg" /> -->
                                <div class="step-oval">
                                    <span><i class="pi fa fa-plus text-clr588 fnt-16"></i></span>
                                </div>
                                <span class="d-none d-sm-none d-md-block secondary_txt dragColor my-25 px-4"
                                    >Drag and drop or upload an image</span
                                >
                                <span class="d-none d-sm-none d-md-block secondary_txt dragColor">(max size 2mb)</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </ng-container>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-2 mb-3 d-flex">
            <span class="fnt-14"><span class="editBtn cursor-pointer" (click)="addStep()">Add another step</span></span>
        </div>
        <div class="d-flex col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 align-items-center my-4">
            <p-checkbox
                [binary]="true"
                label="Allow translations by other authors"
                formControlName="allow_translation"
            ></p-checkbox>
            <i class="pi pi-info-circle text-clr588 fnt-16 ml-2"></i>
        </div>
        <div class="row mt-2 col-sm-12 pr-0">
            <div class="col-md-6 order-2 order-md-1">
                <button routerLink="/coffee-lab/overview/qa-forum" class="btn-stroked px-4 w-mob-100 mb-2 mb-md-0">
                    {{ 'cancel' | translate }}
                </button>
            </div>
            <div class="col-md-6 order-1 order-md-2 p-0">
                <div class="d-flex justify-content-end flex-column flex-md-row">
                    <button class="btn-stroked px-4 order-2 order-md-1 w-mob-100 mb-2 mb-md-0">
                        {{ 'save_as_draft' | translate }}
                    </button>
                    <button
                        (click)="onSave()"
                        class="btn-raised px-4 ml-md-3 order-1 order-md-2 w-mob-100 mb-2 mb-md-0"
                    >
                        {{ 'submit' | translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
