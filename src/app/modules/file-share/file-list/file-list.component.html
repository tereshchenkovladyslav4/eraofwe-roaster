<p-table
    [value]="fileShareSrv.myFileList | filter: fileShareSrv.filesTerm"
    [columns]="tableColumns"
    [loading]="fileShareSrv.loading"
    dataKey="id"
    [resizableColumns]="true"
    [paginator]="false"
    selectionMode="multiple"
    [(selection)]="selectedItems"
    [showCurrentPageReport]="false"
    [paginator]="false"
    [lazy]="true"
    (onLazyLoad)="filterCall($event)"
    [totalRecords]="totalCount"
    [responsive]="true"
>
    <ng-template pTemplate="header" let-columns>
        <tr>
            <th style="width: 8%" class="">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
            </th>
            <th *ngFor="let col of columns" [style.width]="col.width ? col.width + '%' : '30%'">
                <span [pSortableColumn]="col.sortable ? col.field : ''">
                    {{ col.header | translate }}
                    <p-sortIcon *ngIf="col.sortable" [field]="col.field"> </p-sortIcon>
                </span>
            </th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr class="">
            <td class="d-none d-sm-none d-md-table-cell">
                <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
            </td>
            <td
                *ngFor="let col of columns"
                [ngSwitch]="col.field"
                [style.width]="col.width ? col.width + '%' : '30%'"
                [ngClass]="{
                    'd-none':
                        col.field == 'id' || col.field == 'created_at' || col.field == 'price' || col.field == 'type',
                    'd-md-table-cell':
                        col.field == 'id' || col.field == 'created_at' || col.field == 'price' || col.field == 'type'
                }"
            >
                <ng-container *ngSwitchCase="'name'">
                    <span
                        class="d-flex align-items-center"
                        *ngIf="rowData.type == 'FOLDER'"
                        routerLink="/file-share/file-share-details"
                        [queryParams]="{ folderId: rowData.id }"
                    >
                        <img class="file-icon" src="assets/images/folder.svg" alt="upload-icon" />
                        {{ rowData[col.field] }}
                    </span>
                    <span
                        class="d-flex align-items-center"
                        *ngIf="rowData.type == 'DOCUMENT'"
                        (click)="fileShareSrv.downloadFile(rowData)"
                    >
                        <img class="file-icon" src="assets/images/pdf.svg" alt="upload-icon" />
                        {{ rowData[col.field] }}</span
                    >
                    <span class="d-flex align-items-center" *ngIf="rowData.type == 'CSV'">
                        <img class="file-icon" src="assets/images/csv.svg" alt="upload-icon" /> {{ rowData[col.field] }}
                    </span>
                    <span
                        class="d-flex align-items-center"
                        *ngIf="rowData.type == 'VIDEO'"
                        (click)="fileShareSrv.preview(rowData)"
                    >
                        <img class="file-icon" src="assets/images/video.svg" alt="upload-icon" />
                        {{ rowData[col.field] }}
                    </span>
                    <span
                        class="d-flex align-items-center"
                        *ngIf="rowData.type == 'IMAGE'"
                        (click)="fileShareSrv.preview(rowData)"
                    >
                        <img class="file-icon" style="height: 20px" src="assets/images/image.svg" alt="upload-icon" />
                        {{ rowData[col.field] }}
                    </span>
                </ng-container>

                <span *ngSwitchCase="'updated_at'" class="">
                    <span>{{ rowData[col.field] | date: 'dd/MM/yyyy, hh:mm a' }}</span>
                </span>

                <span *ngSwitchCase="'actions'" class="">
                    <span class="d-flex justify-content-between align-items-center">
                        <span class="tr-hover-visible">
                            <span
                                class="btn-trans-icon upload-icon mr-3"
                                (click)="fileShareSrv.openShareModal(rowData)"
                            >
                                {{ 'share' | translate }}
                            </span>
                        </span>
                        <span>
                            <a (click)="selectedFile = rowData; menu.toggle($event)">
                                <img src="assets/images/menu-gray.svg" alt="menu" />
                            </a>
                        </span>
                    </span>
                </span>

                <ng-container *ngSwitchDefault>
                    <span>{{ rowData[col.field] || '-' }}</span>
                </ng-container>
            </td>
        </tr>
    </ng-template>
</p-table>

<p-menu #menu [popup]="true" [model]="menuItems"></p-menu>
