<div *ngIf="(fileShareSrv.viewMode$ | async) === 'table'; else gridView">
    <p-table
        [value]="fileShareSrv.myFileList | filter: fileShareSrv.filesTerm"
        [columns]="tableColumns"
        [loading]="fileShareSrv.loading"
        dataKey="id"
        [resizableColumns]="true"
        [paginator]="false"
        selectionMode="multiple"
        [(selection)]="selectedItems"
        [showCurrentPageReport]="false"
        [paginator]="false"
        [lazy]="true"
        (onLazyLoad)="filterCall($event)"
        [totalRecords]="totalCount"
        [responsive]="true"
    >
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th style="width: 8%" class="">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                </th>
                <th *ngFor="let col of columns" [style.width]="col.width ? col.width + '%' : '30%'">
                    <span [pSortableColumn]="col.sortable ? col.field : ''">
                        {{ col.header | translate }}
                        <p-sortIcon *ngIf="col.sortable" [field]="col.field"> </p-sortIcon>
                    </span>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr class="">
                <td class="d-none d-sm-none d-md-table-cell">
                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                </td>
                <td
                    *ngFor="let col of columns"
                    [ngSwitch]="col.field"
                    [style.width]="col.width ? col.width + '%' : '30%'"
                    [ngClass]="{
                        'd-none':
                            col.field == 'order_ids' ||
                            col.field == 'updated_at' ||
                            col.field == 'type' ||
                            col.field == 'actions',
                        'd-md-table-cell':
                            col.field == 'order_ids' ||
                            col.field == 'updated_at' ||
                            col.field == 'type' ||
                            col.field == 'actions'
                    }"
                >
                    <ng-container *ngSwitchCase="'name'">
                        <span class="d-flex justify-content-between align-items-start">
                            <span class="d-flex align-items-start align-items-md-center">
                                <img class="file-icon" [src]="rowData.type | fileIcon" alt="upload-icon" />
                                <div>
                                    <div
                                        *ngIf="rowData.type == 'FOLDER'"
                                        routerLink="/file-share/file-share-details/{{ rowData.id }}"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'DOCUMENT'"
                                        (click)="fileShareSrv.downloadFile(rowData)"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'CSV'"
                                        routerLink="/file-share/file-share-details/{{ rowData.id }}"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div *ngIf="rowData.type == 'VIDEO'" (click)="fileShareSrv.preview(rowData)">
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div *ngIf="rowData.type == 'IMAGE'" (click)="fileShareSrv.preview(rowData)">
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div class="fnt-12 lh-normal text-clr588 mt-z5 d-md-none">
                                        Modified by {{ rowData.owner_name }}
                                    </div>
                                    <div *ngIf="rowData.order_ids" class="fnt-12 lh-normal text-clr588 d-md-none">
                                        #{{ rowData.order_ids }}
                                    </div>
                                </div>
                            </span>
                            <span class="d-md-none">
                                <a (click)="selectedFile = rowData; menu.toggle($event)">
                                    <img src="assets/images/menu-gray.svg" alt="menu" />
                                </a>
                            </span>
                        </span>
                    </ng-container>

                    <span *ngSwitchCase="'updated_at'" class="">
                        <span>{{ rowData[col.field] | date: 'dd/MM/yyyy, hh:mm a' }}</span>
                    </span>

                    <span *ngSwitchCase="'actions'" class="">
                        <span class="d-flex justify-content-between align-items-center">
                            <span class="tr-hover-visible">
                                <span
                                    class="btn-trans-icon share-icon mr-3"
                                    (click)="fileShareSrv.openShareModal(rowData)"
                                >
                                    {{ 'share' | translate }}
                                </span>
                            </span>
                            <span>
                                <a (click)="selectedFile = rowData; menu.toggle($event)">
                                    <img src="assets/images/menu-gray.svg" alt="menu" />
                                </a>
                            </span>
                        </span>
                    </span>

                    <ng-container *ngSwitchDefault>
                        <span>{{ rowData[col.field] || '-' }}</span>
                    </ng-container>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<ng-template #gridView>
    <ng-container *ngIf="!fileShareSrv.loading; else loading">
        <div *ngIf="listType != 'video'" class="row gutter-20 v-gutter-20 mt-3">
            <div
                class="col-md-4 col-lg-3"
                *ngFor="let item of fileShareSrv.myFileList | filter: fileShareSrv.filesTerm"
            >
                <app-file-card [data]="item"></app-file-card>
            </div>
        </div>
        <div *ngIf="listType == 'video'" class="mt-3">
            <div *ngFor="let folder of fileShareSrv.videoList" class="mb-45 mb-md-5">
                <div class="row no-wrap gutter-20">
                    <div class="col-md-4 col-lg-3" *ngFor="let item of folder.files | filter: fileShareSrv.filesTerm">
                        <app-video-card [data]="item"></app-video-card>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
    <ng-template #loading><app-loading></app-loading></ng-template>
</ng-template>
<p-menu #menu [popup]="true" [model]="menuItems"></p-menu>
