<div *ngIf="(fileShareSrv.viewMode$ | async) === 'table'; else gridView">
    <p-table
        [value]="fileShareSrv.mainData"
        [columns]="tableColumns"
        [loading]="fileShareSrv.loading"
        dataKey="id"
        [resizableColumns]="true"
        [paginator]="false"
        selectionMode="multiple"
        [(selection)]="selectedItems"
        [showCurrentPageReport]="false"
        [paginator]="false"
        [totalRecords]="totalCount"
        [responsive]="true"
    >
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th style="width: 8%" class="">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                </th>
                <th *ngFor="let col of columns" [style.width]="col.width ? col.width + '%' : '30%'">
                    <span [pSortableColumn]="col.sortable ? col.field : ''">
                        {{ col.header | translate }}
                        <p-sortIcon *ngIf="col.sortable" [field]="col.field"> </p-sortIcon>
                    </span>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr class="">
                <td class="d-none d-sm-none d-md-table-cell">
                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                </td>
                <td
                    *ngFor="let col of columns"
                    [ngSwitch]="col.field"
                    [style.width]="col.width ? col.width + '%' : '30%'"
                    [ngClass]="{
                        'd-none':
                            col.field == 'order_ids' ||
                            col.field == 'updated_at' ||
                            col.field == 'type' ||
                            col.field == 'actions',
                        'd-md-table-cell':
                            col.field == 'order_ids' ||
                            col.field == 'updated_at' ||
                            col.field == 'type' ||
                            col.field == 'actions'
                    }"
                >
                    <ng-container *ngSwitchCase="'name'">
                        <span class="d-flex justify-content-between align-items-start">
                            <span class="col-10 col-md-12 px-0 d-flex align-items-start align-items-md-center">
                                <img class="file-icon" [src]="rowData.type | fileIcon" alt="upload-icon" />
                                <div class="col-10 px-0">
                                    <div
                                        *ngIf="rowData.type == 'FOLDER'"
                                        routerLink="/file-share/file-share-details/{{ rowData.id }}"
                                        class="ellipsis"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'DOCUMENT'"
                                        (click)="fileShareSrv.downloadFile(rowData)"
                                        class="ellipsis"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'CSV'"
                                        routerLink="/file-share/file-share-details/{{ rowData.id }}"
                                        class="ellipsis"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'VIDEO'"
                                        (click)="fileShareSrv.preview(rowData)"
                                        class="ellipsis"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div
                                        *ngIf="rowData.type == 'IMAGE'"
                                        (click)="fileShareSrv.preview(rowData)"
                                        class="ellipsis"
                                    >
                                        {{ rowData[col.field] }}
                                    </div>
                                    <div class="fnt-12 lh-normal text-clr588 mt-z5 d-md-none ellipsis">
                                        Modified by {{ rowData.owner_name }}
                                    </div>
                                    <div *ngIf="rowData.order_ids" class="fnt-12 lh-normal text-clr588 d-md-none">
                                        #{{ rowData.order_ids }}
                                    </div>
                                </div>
                            </span>
                            <span class="d-md-none">
                                <a (click)="selectedFile = rowData; menu.toggle($event)">
                                    <img src="assets/images/menu-gray.svg" alt="menu" />
                                </a>
                            </span>
                        </span>
                    </ng-container>

                    <span *ngSwitchCase="'order_ids'" class="">
                        <span>{{ rowData[col.field] ? '#' + rowData[col.field] : '-' }}</span>
                    </span>

                    <span *ngSwitchCase="'type'" class="">
                        <span>{{ rowData[col.field] | titlecase }}</span>
                    </span>

                    <span *ngSwitchCase="'updated_at'" class="">
                        <span>{{ rowData[col.field] | date: 'dd/MM/yyyy, hh:mm a' }}</span>
                    </span>

                    <span *ngSwitchCase="'actions'" class="">
                        <span class="d-flex justify-content-end justify-content-lg-between align-items-center">
                            <span class="tr-hover-visible d-none d-lg-block">
                                <span
                                    class="btn-trans-icon share-icon mr-3"
                                    (click)="fileShareSrv.openShareModal(rowData)"
                                >
                                    {{ 'share' | translate }}
                                </span>
                            </span>
                            <span>
                                <a (click)="selectedFile = rowData; menu.toggle($event)">
                                    <img src="assets/images/menu-gray.svg" alt="menu" />
                                </a>
                            </span>
                        </span>
                    </span>

                    <ng-container *ngSwitchDefault>
                        <span>{{ rowData[col.field] || '-' }}</span>
                    </ng-container>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<ng-template #gridView>
    <ng-container *ngIf="!fileShareSrv.loading; else loading">
        <div class="pt-3 pt-md-0">
            <div *ngIf="listType != 'video'" class="row gutter-20 v-gutter-16 v-gutter-md-20">
                <div class="col-md-4 col-lg-3" *ngFor="let item of fileShareSrv.mainData">
                    <app-file-card [data]="item"></app-file-card>
                </div>
            </div>
            <div *ngIf="listType == 'video'" class="row no-wrap gutter-20 v-gutter-16 v-gutter-md-20">
                <div class="col-md-4 col-lg-3" *ngFor="let item of fileShareSrv.mainData">
                    <app-video-card *ngIf="item.type == 'VIDEO'" [data]="item"></app-video-card>
                    <app-file-card *ngIf="item.type == 'FOLDER'" [data]="item"></app-file-card>
                </div>
            </div>
        </div>
    </ng-container>
    <ng-template #loading><app-loading></app-loading></ng-template>
</ng-template>

<p-menu #menu [popup]="true" [model]="menuItems"></p-menu>

<ng-container *ngIf="!fileShareSrv.mainData?.length">
    <app-empty title="No data available"></app-empty>
</ng-container>
