<section class="estate-orders">
    <div class="d-flex justify-content-between mt-4 pt-2">
        <div>
            <p-dropdown
                id="select-table-customer"
                [options]="newList"
                [(ngModel)]="selectedCustomers"
                scrollHeight="225px"
                (onChange)="filterAgrements()"
                [showClear]="true"
                placeholder="Select customer"
                styleClass="round-border mr-25 mb-25 mb-md-4"
            ></p-dropdown>
        </div>
        <div class="web-farm">
            <div class="float-right" data-toggle="modal" data-target="#uploadfolder">
                <label class="upload-btn" (click)="onUploadModalOpen()">
                    <img class="dwnd-img" src="assets/images/group-6.svg" alt="upload-icon" />
                    <span class="upload-name">&nbsp; Upload </span>
                </label>
            </div>
        </div>
    </div>
    <div class="estate-table web-farm">
        <p-table
            id="sales-table"
            [value]="sortedMainData | filter: searchTerm | filter: estatetermOrigin"
            sortMode="multiple"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="file_name" class="pl-4 ml-3 cust-width">
                        {{ globals.languageJson?.files }} <p-sortIcon field="file_name"> </p-sortIcon>
                    </th>
                    <th pSortableColumn="created_at">
                        {{ globals.languageJson?.added_on }} <p-sortIcon field="created_at"> </p-sortIcon>
                    </th>
                    <th pSortableColumn="customer_name">
                        {{ globals.languageJson?.customer_name }} <p-sortIcon field="customer_name"></p-sortIcon>
                    </th>
                    <th pSortableColumn="origin">
                        {{ globals.languageJson?.origin }} <p-sortIcon field="origin"> </p-sortIcon>
                    </th>
                    <th style="width: 5%"></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
                <tr>
                    <td class="pl-4 ml-3">
                        <a href="{{ item.file_url }}" target="_blank" class="file_url">
                            <div>
                                <img class="file-icon pr-2" src="assets/images/pdf.svg" alt="upload-icon" />
                                {{ item.file_name }}
                            </div>
                        </a>
                    </td>
                    <td class="fnt-14">{{ item.created_at | date: 'M/d/yy, h:mm a' }}</td>
                    <td class="fnt-14">{{ item.customer_name }}</td>
                    <td class="fnt-14">{{ getCountryName(item.origin) }}</td>
                    <td id="sales-contract-popup">
                        <a
                            class="menu-arrow"
                            [popover]="poplistTemplate"
                            placement="left"
                            [outsideClick]="true"
                            #pop="bs-popover"
                        >
                            <p><img src="assets/images/kebab-menu.svg" /></p>
                        </a>
                        <ng-template #poplistTemplate id="{{ item.id }}">
                            <div id="popover-mobile-content">
                                <ul class="list-group custom-popover">
                                    <li class="list-group-item">
                                        <a
                                            class="pointer-item"
                                            (click)="pop.hide(); onUpdateModal(item.id)"
                                            data-toggle="modal"
                                            data-target="#uploadfolder"
                                            >{{ globals.languageJson?.update }}</a
                                        >
                                    </li>
                                    <li class="list-group-item">
                                        <a
                                            class="pointer-item"
                                            (click)="pop.hide(); deleteAgreementId = item.id"
                                            data-toggle="modal"
                                            data-target="#deletemodal"
                                            >{{ globals.languageJson?.delete }}</a
                                        >
                                    </li>
                                </ul>
                            </div>
                        </ng-template>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <div class="estate-table pt-md-2 mobile-farm">
        <div class="table-details mobile-farm">
            <div class="table-responsive border-sourcetable agreement-top">
                <div class="col-12 mb-3 bor-ebe" *ngFor="let data of sortedMainData | filter: customerMob">
                    <div class="row">
                        <div class="col-12 mobile-ce p-0">
                            <div class="d-flex justify-content-between bg-f4f4 py-2 px-3">
                                <div>
                                    <p class="black fnt-14">{{ data.file_name }}</p>
                                </div>
                                <div>
                                    <a
                                        [popover]="poplistTemplate"
                                        placement="left"
                                        [outsideClick]="true"
                                        #pop="bs-popover"
                                    >
                                        <p><img src="assets/images/kebab-menu.svg" /></p>
                                    </a>
                                    <ng-template #poplistTemplate id="{{ data.id }}">
                                        <div id="popover-mobile-content">
                                            <ul class="list-group custom-popover">
                                                <li class="list-group-item">
                                                    <a
                                                        class="pointer-item"
                                                        [routerLink]="'/sales-contract/' + customerType + '/' + data.id"
                                                        (click)="pop.hide(); onUpdateModal(data.id)"
                                                        >{{ globals.languageJson?.update }}</a
                                                    >
                                                </li>
                                                <li class="list-group-item">
                                                    <a
                                                        class="pointer-item"
                                                        (click)="pop.hide(); deleteAgreementId = data.id"
                                                        data-toggle="modal"
                                                        data-target="#deletemodal"
                                                        >{{ globals.languageJson?.delete }}</a
                                                    >
                                                </li>
                                            </ul>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
                            <div class="bor-bot-d6d6 mx-3 py-3 row">
                                <div class="col-5 p-0">
                                    <p class="light-eight fnt-12">Customer name</p>
                                </div>
                                <div class="col-7 p-0">
                                    <p class="fnt-12">{{ data.customer_name }}</p>
                                </div>
                            </div>
                            <div class="bor-bot-d6d6 mx-3 py-3 row">
                                <div class="col-5 p-0">
                                    <p class="light-eight fnt-12">Origin</p>
                                </div>
                                <div class="col-7 p-0">
                                    <p class="fnt-12">{{ getCountryName(data.origin) }}</p>
                                </div>
                            </div>
                            <div class="row mx-3 mb-3 pt-3">
                                <div class="col-5 p-0">
                                    <p class="light-eight fnt-12">Date added</p>
                                </div>
                                <div class="col-7 p-0">
                                    <p class="fnt-12">{{ data.created_at | date: 'M/d/yy, h:mma' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div
    class="modal fade"
    id="uploadfolder"
    tabindex="-1"
    role="dialog"
    data-backdrop="static"
    data-keyboard="false"
    aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered modal-dialog-lg modal-large" role="document">
        <app-roaster-agreement-form
            class="w-100"
            [isUpdate]="isUpdate"
            [customerType]="customerType"
            [selectedItemId]="selectedItemId"
            (getAgreements)="getAgreements($event)"
        >
        </app-roaster-agreement-form>
    </div>
</div>

<div
    class="modal fade"
    id="deletemodal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered modal-small" role="document">
        <div class="modal-content">
            <div class="modal-body mt-5 mb-5 text-center fnt-muli">
                <div><img src="assets/images/delete-role.svg" alt="" /></div>
                <div class="fnt-muli fnt-18 fnt-normal delete__text mt-3">
                    <p class="oh-noh pb-3 mb-0">Oh noh :(</p>
                    <p class="mb-0">You sure you really want to delete this?</p>
                </div>
                <div class="mt-5">
                    <button class="btn-stroked btn-padding" id="dismissDeleteModal" data-dismiss="modal">
                        {{ globals.languageJson?.cancel }}
                    </button>
                    <button class="btn-raised btn-padding ml-3" (click)="deleteAgreement(deleteAgreementId)">
                        {{ globals.languageJson?.delete }}
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
