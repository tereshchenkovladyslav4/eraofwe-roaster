<section>
    <div class="main-block roaster-profile">
        <div class="row">
            <div class="col-12 col-sm-12 col-md-8 col-lg-8">
                <p-breadcrumb [model]="breadItems"></p-breadcrumb>
            </div>
            <div class="col-12 col-sm-12 col-md-4 col-lg-4">
                <button
                    type="submit"
                    class="btn pull-right btn-raised d-md-block d-none"
                    routerLink="/roasted-coffee-batch/create-roasting-profile"
                >
                    {{ 'create_new' | translate }}
                </button>
            </div>
        </div>
        <div class="row mt-4 mt-md-0">
            <div class="col-12">
                <span class="primary_txt mb-1">{{ 'roasting_profiles' | translate }}</span>
            </div>
        </div>
        <div class="row mt-4 mb-4 d-block d-sm-block d-md-none">
            <div class="col-12 col-sm-12">
                <button
                    type="submit"
                    class="btn btn-raised w-100"
                    [routerLink]="['/roasted-coffee-batch/create-roasting-profile']"
                >
                    {{ 'create_new' | translate }}
                </button>
            </div>
        </div>
        <div class="d-block d-sm-block d-md-none mb-3">
            <input
                type="text"
                name="search"
                class="search-raised w-100 ml-0"
                [(ngModel)]="termSearch"
                (ngModelChange)="getData()"
                placeholder="Search by roast name"
            />
        </div>
        <div class="row mt-md-4 mt-0 pb-2 pb-md-0">
            <div class="col-12 col-sm-12 col-md-6 mt-2 mt-md-0">
                <p-dropdown
                    [options]="roastLevelArray"
                    optionLabel="name"
                    optionValue="id"
                    [(ngModel)]="roastLevelFilter"
                    (onChange)="getData()"
                    scrollHeight="225px"
                    [showClear]="true"
                    placeholder="Roast level"
                    styleClass="round-border mb-3 {{ roastLevelFilter ? 'highlight' : '' }}"
                >
                </p-dropdown>
            </div>
            <div class="d-none d-sm-none d-md-block col-6">
                <input
                    type="text"
                    name="search"
                    class="search-raised pull-right"
                    [(ngModel)]="termSearch"
                    (ngModelChange)="getData()"
                    placeholder="Search by roast name"
                />
            </div>
        </div>

        <div class="mt-2 mt-md-0 mb-2">
            <p-table
                #myTable
                [value]="tableValue"
                [columns]="tableColumns"
                [(selection)]="selectedProfiles"
                dataKey="id"
                [resizableColumns]="true"
                [showCurrentPageReport]="false"
                [paginator]="true"
                [rows]="10"
                [lazy]="true"
                [loading]="isLoadingProfiles"
                (onLazyLoad)="getData($event)"
                [totalRecords]="totalCount"
                selectionMode="multiple"
                [responsive]="true"
                [scrollable]="isTablet$ | async"
                styleClass="mobile-card-view"
            >
                <ng-template pTemplate="header" let-columns>
                    <tr class="d-none d-sm-none d-md-table-row">
                        <th *ngFor="let col of columns" [style.width]="col.width ? col.width + '%' : '30%'">
                            <span class="primeng-table-header">{{ col.header | translate }}</span>
                            <p-sortIcon *ngIf="col.sortable === true" [field]="col.field"> </p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-columns="columns">
                    <tr (click)="redirectToEdit(rowData['id'])">
                        <td
                            *ngFor="let col of columns"
                            [ngSwitch]="col.field"
                            [style.width]="col.width ? col.width + '%' : '30%'"
                        >
                            <span *ngSwitchCase="'roast_profile_name'" class="">
                                <span class="d-none d-md-inline-block">
                                    {{ rowData['roast_profile_name'] }}
                                </span>

                                <div class="d-flex d-md-none">
                                    <span class="fnt-bold">{{ rowData[col.field] }}</span>
                                    <span class="ml-auto" (click)="menuClicked()">
                                        <a
                                            class="menu-arrow"
                                            [popover]="poplistTemplate"
                                            placement="left"
                                            [outsideClick]="true"
                                            #pop="bs-popover"
                                        >
                                            <img class="ellipse-image pl-3" src="assets/images/kebab-menu.svg" alt="" />
                                        </a>
                                        <ng-template #poplistTemplate>
                                            <div id="popover-mobile-content">
                                                <ul class="list-group custom-popover">
                                                    <li class="list-group-item">
                                                        <a
                                                            class="pointer-item"
                                                            (click)="deleteRoastingProfile(rowData['id']); pop.hide()"
                                                            >{{ 'delete' | translate }}</a
                                                        >
                                                    </li>
                                                </ul>
                                            </div>
                                        </ng-template>
                                    </span>
                                </div>
                            </span>
                            <span *ngSwitchCase="'actions'">
                                <span>
                                    <a class="fnt-muli fnt-14 fnt-700 brown-cta">{{ 'view_details' | translate }}</a>
                                    <span (click)="menuClicked()">
                                        <a
                                            class="menu-arrow"
                                            [popover]="poplistTemplate"
                                            placement="left"
                                            [outsideClick]="true"
                                            #pop="bs-popover"
                                        >
                                            <img
                                                class="ellipse-image ml-lg-3 pl-3"
                                                src="assets/images/kebab-menu.svg"
                                                alt=""
                                            />
                                        </a>
                                        <ng-template #poplistTemplate>
                                            <div id="popover-mobile-content">
                                                <ul class="list-group custom-popover">
                                                    <li class="list-group-item">
                                                        <a
                                                            class="pointer-item"
                                                            (click)="deleteRoastingProfile(rowData['id']); pop.hide()"
                                                            >{{ 'delete' | translate }}</a
                                                        >
                                                    </li>
                                                </ul>
                                            </div>
                                        </ng-template>
                                    </span>
                                </span>
                            </span>
                            <span *ngSwitchCase="'roast_level'" class="">
                                <span class="p-column-title">{{ col.header | translate }}</span>
                                <span>{{ getRoastLevel(rowData[col.field]) }}</span>
                            </span>
                            <span *ngSwitchDefault>
                                <span class="p-column-title">{{ col.header | translate }}</span>
                                <span>{{ rowData[col.field] }}</span>
                            </span>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</section>
