<section>
    <div class="main-block roaster-profile">
        <div class="row">
            <div class="col-12 col-sm-12 col-md-8 col-lg-8 overflow-auto d-flex flex-nowrap breadCrumb">
                <p-breadcrumb [model]="breadItems"></p-breadcrumb>
            </div>
            <div class="col-12 col-sm-12 col-md-4 col-lg-4">
                <button
                    type="submit"
                    class="btn pull-right btn-raised d-md-block d-none"
                    routerLink="/roasted-coffee-batch/create-roasting-profile"
                >
                    Create new
                </button>
            </div>
        </div>
        <div class="row mt-4 mt-md-0">
            <div class="col-12">
                <span class="primary_txt mb-1">{{ globals.languageJson?.roasting_profiles }}</span>
            </div>
        </div>
        <div class="row mt-4 mb-4 d-block d-sm-block d-md-none">
            <div class="col-12 col-sm-12">
                <button
                    type="submit"
                    class="btn btn-raised w-100"
                    [routerLink]="['/roasted-coffee-batch/create-roasting-profile']"
                >
                    Create new
                </button>
            </div>
        </div>
        <div class="d-block d-sm-block d-md-none mb-3">
            <input
                    type="text"
                    name="search"
                    class="search-raised w-100 ml-0"
                    [(ngModel)]="termSearch"
                    (ngModelChange)="getData()"
                    placeholder="Search by roast name"
            />
        </div>
        <div class="row mt-md-4 mt-0 pb-2 pb-md-0">
            <div class="col-12 col-sm-12 col-md-6 filterLayout">
                <p-dropdown
                    [options]="roastLevelArray"
                    optionLabel="label"
                    optionValue="value"
                    [(ngModel)]="roastLevelFilter"
                    (onChange)="getData()"
                    scrollHeight="225px"
                    [showClear]="true"
                    placeholder="Roast level"
                    styleClass="round-border mb-3 {{ roastLevelFilter ? 'highlight' : '' }}"
                >
                </p-dropdown>
            </div>
            <div class="d-none d-sm-none d-md-block col-6">
                <input
                    type="text"
                    name="search"
                    class="search-raised pull-right"
                    [(ngModel)]="termSearch"
                    (ngModelChange)="getData()"
                    placeholder="Search by roast name"
                />
            </div>
        </div>

        <div class="userTable mt-2 mt-md-0 mb-2 pt-0 roastingProfileTable">
            <p-table
                #myTable
                [class.table-mobile]="sharedService.isMobileView"
                [value]="tableValue"
                [columns]="tableColumns"
                [(selection)]="selectedProfiles"
                dataKey="id"
                [resizableColumns]="true"
                styleClass="ui-table-customers"
                [showCurrentPageReport]="false"
                [paginator]="true"
                [rows]="10"
                [lazy]="true"
                [loading]="isLoadingProfiles"
                (onLazyLoad)="getData($event)"
                [totalRecords]="totalCount"
                selectionMode="multiple"
                [responsive]="sharedService.isMobileView"
            >
                <ng-template pTemplate="header" let-columns>
                    <tr class="d-none d-sm-none d-md-table-row">
                        <th *ngFor="let col of columns" [style.width]="col.width ? col.width + '%' : '30%'">
                            <span class="primeng-table-header">{{ col.header }}</span>
                            <p-sortIcon
                                *ngIf="col.sortable === true"
                                [field]="col.field"
                                ariaLabel="Activate to sort"
                                ariaLabelDesc="Activate to sort in descending order"
                                ariaLabelAsc="Activate to sort in ascending order"
                            >
                            </p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-columns="columns">
                    <tr (click)="redirectToEdit(rowData['id'])">
                        <td
                            *ngFor="let col of columns"
                            [ngSwitch]="col.field"
                            [style.width]="col.width ? col.width + '%' : '30%'"
                            [ngClass]="{
                                'd-none':
                                    col.field == 'roast_level' ||
                                    col.field == 'temperature' ||
                                    col.field == 'roast_duration' ||
                                    col.field == 'actions',
                                'd-sm-none':
                                    col.field == 'roast_level' ||
                                    col.field == 'temperature' ||
                                    col.field == 'roast_duration' ||
                                    col.field == 'actions',
                                'd-md-table-cell':
                                    col.field == 'roast_level' ||
                                    col.field == 'temperature' ||
                                    col.field == 'roast_duration' ||
                                    col.field == 'actions',
                                nameMobileHeader: col.field == 'roast_profile_name'
                            }"
                        >
                            <span *ngSwitchCase="'roast_profile_name'" class="">
                                <span class="d-none d-sm-none d-md-inline-block">
                                    {{ rowData['roast_profile_name'] | titlecase }}
                                </span>

                                <div class="d-block d-sm-block d-md-none row m-0 pb-4">
                                    <div class="borderRoastedCard">
                                        <div class="d-flex bgRoastedCard">
                                            <span class="fnt-muli fnt-600 width-90">{{
                                                rowData[col.field] | titlecase
                                            }}</span>
                                            <span class="" (click)="menuClicked()">
                                                <a
                                                    class="menu-arrow"
                                                    [popover]="poplistTemplate"
                                                    placement="left"
                                                    [outsideClick]="true"
                                                    #pop="bs-popover"
                                                >
                                                    <img
                                                        class="ellipse-image pl-3"
                                                        src="assets/images/kebab-menu.svg"
                                                        alt=""
                                                    />
                                                </a>
                                                <ng-template #poplistTemplate>
                                                    <div id="popover-mobile-content">
                                                        <ul class="list-group custom-popover">
                                                            <li class="list-group-item">
                                                                <a
                                                                    class="pointer-item"
                                                                    (click)="deleteRoastingProfile(rowData['id']); pop.hide()"
                                                                    >{{ globals.languageJson?.delete }}</a
                                                                >
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </ng-template>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col-12 row p-3 m-0 mobileCard">
                                        <div class="cardBottom p-0 w-100">
                                            <div class="mobileCardBody pt-0">
                                                <div class="d-flex">
                                                    <span class="width-head secondary_txt">Roast name</span>
                                                    <span class="width-desc primary_txt mobileValueTxt fnt-600">{{
                                                        getRoastLevel(rowData['roast_level'])
                                                    }}</span>
                                                </div>
                                            </div>
                                            <div class="mobileCardBody d-flex">
                                                <span class="width-head secondary_txt">Temperature</span>
                                                <span class="width-desc primary_txt mobileValueTxt fnt-600"
                                                    >{{ rowData['temperature'] }}</span
                                                >
                                            </div>

                                            <div class="pt-3 d-flex">
                                                <span class="width-head secondary_txt">Duration</span>
                                                <span class="width-desc primary_txt mobileValueTxt fnt-600"
                                                    >{{ rowData['roast_duration'] }}</span
                                                >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </span>
                            <span *ngSwitchCase="'actions'" class="">
                                <span>
                                    <a class="fnt-muli fnt-14 fnt-700 view-det">View details</a>
                                    <span (click)="menuClicked()">
                                        <a
                                            class="menu-arrow"
                                            [popover]="poplistTemplate"
                                            placement="left"
                                            [outsideClick]="true"
                                            #pop="bs-popover"
                                        >
                                            <img
                                                class="ellipse-image ml-lg-3 pl-3"
                                                src="assets/images/kebab-menu.svg"
                                                alt=""
                                            />
                                        </a>
                                        <ng-template #poplistTemplate>
                                            <div id="popover-mobile-content">
                                                <ul class="list-group custom-popover">
                                                    <li class="list-group-item">
                                                        <a
                                                            class="pointer-item"
                                                            (click)="deleteRoastingProfile(rowData['id']); pop.hide()"
                                                            >{{ globals.languageJson?.delete }}</a
                                                        >
                                                    </li>
                                                </ul>
                                            </div>
                                        </ng-template>
                                    </span>
                                </span>
                            </span>
                            <span *ngSwitchCase="'roast_level'" class="">
                                <span>{{ getRoastLevel(rowData[col.field]) }}</span>
                            </span>
                            <span *ngSwitchCase="'temperature'" class="">
                                <span>{{ rowData[col.field] }}</span>
                            </span>
                            <span *ngSwitchCase="'roast_duration'" class="">
                                <span>{{ rowData[col.field] }}</span>
                            </span>
                            <span *ngSwitchDefault>
                                <span>{{ rowData[col.field] }}</span>
                            </span>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</section>
