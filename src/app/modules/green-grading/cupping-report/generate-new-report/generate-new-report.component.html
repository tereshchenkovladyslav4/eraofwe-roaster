<div class="sewn-container prime-grid">
    <div class="bg-fff content-wrapper">
        <div class="back-page pb-45" (click)="back()">
            <a>
                <span>Back</span>
            </a>
        </div>
        <section class="grading__total pt-2">
            <div class="d-flex flex-wrap justify-content-between flex-column flex-md-row">
                <div class="green_grading_cont d-none d-md-block">
                    <h1 class="mb-2">{{ title }}</h1>
                    <h3 class="mb-0 mt-1">Select the details of the report you want to generate</h3>
                </div>
                <label class="d-block d-md-none fnt-head fnt-29 fnt-normal text-clr334" style="font-size: 20px">{{
                    title
                }}</label>
            </div>

            <div class="mt-3 mt-md-4">
                <app-estate-info
                    [cuppingDetails]="eachServiceData"
                    [singleCuppingDetails]="singleCuppingDetails"
                    [evaluatorName]="evaluatorName"
                    (showDetail)="routeToProcessDet()"
                ></app-estate-info>
            </div>

            <div class="cupping-report px-3 px-md-4 pt-3 pt-md-4 pb-0 pb-md-2 my-4 my-md-5">
                <div
                    *ngIf="singleCuppingDetails"
                    class="d-flex justify-content-between align-items-center header-wrapper pr-1"
                >
                    <div>
                        <div class="p-field-radiobutton pt-0 pl-0 pb-3 pb-md-2 ml-0">
                            <label for="version" class="ml-0 fnt-18 fw-b text-clr334 mb-0 mb-md-2">
                                Cupping Report {{ singleCuppingDetails.version }}.0
                            </label>
                        </div>
                        <p class="fnt-14 fw-n text-clr588 mb-0 pt-md-1 generate_date pl-0">
                            Generated on: {{ singleCuppingDetails.generated_on | date: 'dd/MM/y' }}
                        </p>
                    </div>
                    <div class="pb-3 pb-md-0">
                        <p class="average_score_value">{{ singleCuppingDetails.average_score }}</p>
                        <p class="average_score_label">Average score</p>
                    </div>
                </div>
                <div class="bottom-dash d-block d-md-none ml-0 mb-1"></div>
                <p class="fnt-14 fnt-normal text-clr588 mb-3 pt-3 pt-md-2 md-mb-0">Select Evaluators</p>
                <div *ngIf="generateStep === 0">
                    <div class="p-field-checkbox my-3" *ngFor="let eval of evalDataList; let j = index">
                        <p-checkbox name="group1" [value]="eval" [(ngModel)]="filterEval" inputId="sf"> </p-checkbox>
                        <label class="fnt-14 fw-m mb-0 text-clr334" for="sf">
                            {{ j + 1 }}. {{ eval.evaluator_name }}
                            <span *ngIf="eval.is_primary == true">(You)</span>
                            /{{ eval.evaluator_type }} ({{ eval.final_score }})
                        </label>
                    </div>
                </div>
                <div *ngIf="generateStep === 1">
                    <div class="my-3" *ngFor="let eval of filterEval; let j = index">
                        <label class="fnt-14 fw-m mb-0 text-clr334" for="sf">
                            {{ j + 1 }}. {{ eval.evaluator_name }}
                            <span *ngIf="eval.is_primary == true">(You)</span>
                            /{{ eval.evaluator_type }} ({{ eval.final_score }})
                        </label>
                    </div>
                </div>
            </div>

            <div class="w-100">
                <div
                    *ngIf="generateStep === 0"
                    class="d-flex flex-wrap justify-content-between flex-column flex-md-row flex-md-row-reverse w-100"
                >
                    <div class="green-button btn-raised mb-2 mb-md-0" tabindex="0" (click)="generateReport()">
                        Generate report
                    </div>
                    <div class="green-button btn-stroked" (click)="back()">Cancel</div>
                </div>
                <div
                    *ngIf="generateStep === 1"
                    class="mt-2 mt-md-0 d-flex flex-md-row justify-content-end flex-column button-wrapper"
                >
                    <button
                        pButton
                        class="p-button-outlined mr-0 mr-md-3 mb-1 mb-md-0"
                        label="Download as PDF"
                        icon="pi pi-download"
                        iconPos="left"
                        (click)="downloadReport()"
                    ></button>
                </div>
            </div>
        </section>
    </div>
</div>

<p-dialog
    *ngIf="showProcessDetail"
    header=""
    [closable]="false"
    [draggable]="false"
    [resizable]="false"
    styleClass="p-dialog-processdetails"
    [(visible)]="showProcessDetail"
>
    <app-process-details *ngIf="eachServiceData" [harvestId]="eachServiceData.harvest_id" (back)="closeModal()">
    </app-process-details>
</p-dialog>
