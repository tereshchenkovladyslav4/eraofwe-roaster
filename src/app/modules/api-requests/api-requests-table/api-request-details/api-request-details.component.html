<section>
    <div *ngIf="loader">
        <img class="loader-gif web-loader" src="/assets/images/loader.gif" />
    </div>
    <div class="api-request-detail-container" *ngIf="!loader">
        <div class="breadCrumb-block">
            <p-breadcrumb [model]="breadCrumbItem"></p-breadcrumb>
        </div>
        <div class="request-details">
            <h4 class="fnt-18 fnt-muli fnt-700 text-clr334">{{ globals.languageJson?.request_details }}</h4>
            <p class="fnt-14 fnt-muli fnt-400 text-clr588">
                {{ 'Accept, reject API key requests by customers and generate API keys.' | translate }}
            </p>
        </div>

        <div class="row m-0">
            <div class="col-md-7 col-12 table-responsive mt-4 p-0">
                <div class="express__delivery">
                    <div class="delivery__head">
                        <p class="m-0 fnt-14 fnt-muli fnt-700 black">{{ 'API Key Generation Request' | translate }}</p>
                    </div>
                    <div class="delivery__body">
                        <div class="w-100" *ngIf="apikeyStatus != 'DELETED'">
                            <div class="float-left key-activate-block">
                                <p class="m-0 fnt-14 fnt-muli fnt-700 black">
                                    {{ 'Key activated on' | translate }}
                                    {{
                                        initialStatus == 'GENERATED'
                                            ? (requestDetailData?.requested_at | date: 'MMMM y')
                                            : (requestDetailData?.created_at | date: 'MMMM y')
                                    }}
                                </p>
                                <p class="view-order m-0 pt-16 cursor-pointer" (click)="delete()">
                                    {{ 'Delete Key' | translate }}
                                </p>
                            </div>

                            <div class="float-right">
                                <div
                                    class="btn-group btn-toggle ml-auto pull-right active__main"
                                    (click)="activeStatus()"
                                >
                                    <div
                                        class="btn btn-group__item"
                                        [ngClass]="btnToggle ? 'active_default' : 'active disable_default'"
                                        id="activeStatus"
                                    >
                                        {{ 'Active' | translate }}
                                    </div>
                                    <div
                                        class="btn btn-group__item"
                                        (click)="pause()"
                                        [ngClass]="!btnToggle ? 'active_default active' : 'disable_default'"
                                        id="disableStatus"
                                    >
                                        {{ 'Pause' | translate }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <table class="table lot-table">
                            <tbody>
                                <tr>
                                    <td class="pl-16">
                                        <span class="list-ques float-left text-clr588">
                                            {{ 'Requested by' | translate }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="list-answ float-right">
                                            {{ requestDetailData?.org_name }}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="pl-16">
                                        <span class="list-ques float-left text-clr588">
                                            {{ 'Customer Type' | translate }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="list-answ float-right">
                                            {{ requestDetailData?.org_type }}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="pl-16">
                                        <span class="list-ques float-left text-clr588">
                                            {{ 'Requested on' | translate }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="list-answ float-right">
                                            {{
                                                initialStatus == 'GENERATED'
                                                    ? (requestDetailData?.requested_at | date: 'MMMM y')
                                                    : (requestDetailData?.created_at | date: 'MMMM y')
                                            }}</span
                                        >
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-heading" *ngIf="apikeyStatus == 'DELETED'">
            <div>
                <p class="fnt-14 fnt-muli fnt-700 text-clr334">{{ 'NOTE :' | translate }}</p>
            </div>

            <div class="col-md-6 pl-8">
                <p class="fnt-14 fnt-muli fnt-700 text-clr588 m-0">
                    {{
                        'Confirming the request will grant the customer to all the coffee stories for their orders and all
                    the marketing material.'
                            | translate
                    }}
                </p>
            </div>
        </div>

        <div class="d-flex" *ngIf="apikeyStatus == 'DELETED'">
            <div class="generate-border col-md-7 col-12">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 col-8 float-left m-0 p-0">
                    {{
                        'Confirm the API Key generation request, to allow the customer to access coffee story.'
                            | translate
                    }}
                </p>
                <button
                    type="submit"
                    class="save float-right"
                    (click)="generateKey()"
                    [disabled]="resetButtonValue === 'Generating Key…'"
                >
                    <img
                        class="loader"
                        *ngIf="resetButtonValue === 'Generating Key…'"
                        src="assets/images/btn-loader.svg"
                    />
                    {{ resetButtonValue | translate }}
                </button>
            </div>
        </div>

        <!-- API key is generated -->
        <div class="d-flex pt-32" *ngIf="apikeyStatus == 'GENERATED'">
            <div class="generate-border col-md-7 col-12">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 col-8 float-left m-0 p-0">
                    <span><img class="mr-2" src="assets/images/correct.png" alt="" /> </span>
                    {{ 'The API key is generated!' | translate }}
                </p>
                <button class="save float-right" (click)="notify()">{{ 'Notify now' | translate }}</button>
            </div>
        </div>

        <!-- The API key is generated and the customer is notified!-->
        <div class="d-flex pt-16" *ngIf="apikeyStatus == 'Notified'">
            <div class="generate-border col-md-7 col-12">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 float-left m-0">
                    <span><img class="mr-2" src="assets/images/correct.png" alt="" /> </span> The API key is generated
                    and the customer is notified!
                </p>
            </div>
        </div>

        <!-- pause-->
        <div class="d-flex pt-32" *ngIf="apikeyStatus == 'paused'">
            <div class="generate-border col-md-7 col-12">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 float-left m-0">
                    <span><img class="mr-2" src="assets/images/pause.png" alt="" /> </span> The API key access is paused
                </p>
            </div>
        </div>

        <div class="d-flex pt-16" *ngIf="apikeyStatus == 'paused'">
            <div class="col-md-7 col-12 p-0">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 float-left m-0">
                    The customer can send a key access reactivation request. When you get the request, activate the key
                    access.
                </p>
            </div>
        </div>

        <div class="d-flex pt-32" *ngIf="apikeyStatus == 'active'">
            <div class="generate-border col-md-7 col-12">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 float-left m-0">
                    <span><img class="mr-2" src="assets/images/pause.png" alt="" /> </span> The API key access has
                    reactivated and the customer is notified!!
                </p>
            </div>
        </div>

        <ng-template #deletetemplate>
            <div class="templete-modal-body text-center" *ngIf="!isDeletedApiKey">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 m-0">
                    Are you sure you want to delete the API key for "Third wave coffee roasters"?
                </p>
                <div class="templete-btn">
                    <button class="btn btn-stroked" (click)="modalRef.hide()">Cancel</button>
                    <button class="btn btn-raised ml-3" (click)="onConfirm()">Yes</button>
                </div>
            </div>

            <div class="delete-confirmation-modal-body text-center mb-2" *ngIf="isDeletedApiKey">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 float-left m-0">
                    <span><img class="mr-2" src="assets/images/correct.png" alt="" /> </span> The Api Key Is Deleted.
                </p>
            </div>
        </ng-template>

        <ng-template #pausetemplate>
            <div class="templete-modal-body text-center">
                <p class="fnt-14 fnt-muli fnt-700 text-clr334 m-0">
                    Are you sure you want to Pause API key access for "Third wave coffee roasters"?
                </p>
                <div class="templete-btn">
                    <button class="btn btn-stroked" (click)="modalRef.hide()">{{ 'Cancel' | translate }}</button>
                    <button class="btn btn-raised ml-3" (click)="confirmPauseKey()">{{ 'Yes' | translate }}</button>
                </div>
            </div>
        </ng-template>
    </div>
</section>
